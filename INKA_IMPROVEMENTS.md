# –£–ª—É—á—à–µ–Ω–∏–µ INKA - –ß–µ–ª–æ–≤–µ—á–Ω—ã–π –¥–∏–∞–ª–æ–≥ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏

## –ß—Ç–æ –±—ã–ª–æ —É–ª—É—á—à–µ–Ω–æ

### 1. **–ù–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è —á–µ–ª–æ–≤–µ—á–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è**
INKA —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã:
- **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (S1)**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–î–∏–∞–ª–æ–≥–æ–≤—ã–π —Ä–µ–∂–∏–º**: –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ —Å –∫–ª–∏–µ–Ω—Ç–æ–º

### 2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenAI Assistant API**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–∞—à –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç `asst_LBGeLxauJ3nYbauR3pilbifN`
- Assistant API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- –ë–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞

### 3. **–ò—Å—Ç–æ—Ä–∏—è —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤**
- –ë–æ—Ç –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å–æ–æ–±—â–µ–Ω–∏–π
- –ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- –ë–æ–ª–µ–µ —Å–≤—è–∑–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã

### 4. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞–º–µ—Ä–µ–Ω–∏–π**
–ù–æ–≤—ã–µ —Ç–∏–ø—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤:
- `conversation` - –æ–±—ã—á–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä, –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
- `info` - –≤–æ–ø—Ä–æ—Å—ã –æ —Ü–µ–Ω–∞—Ö, —É—Ö–æ–¥–µ, –±–æ–ª–∏
- `consultation` - –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –∏–¥–µ–∏ —Ç–∞—Ç—É–∏—Ä–æ–≤–∫–∏
- `booking` - –∑–∞–ø–∏—Å—å –Ω–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä—É
- `booking_reschedule` - –ø–µ—Ä–µ–Ω–æ—Å –∑–∞–ø–∏—Å–∏
- `other` - –æ—Å—Ç–∞–ª—å–Ω–æ–µ

### 5. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPT-4o-mini**
- –ë–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è
- –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
```bash
python setup_openai.py
```

–ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤—Ä—É—á–Ω—É—é –≤ `.env`:
```env
OPENAI_API_KEY=sk-–≤–∞—à-–∫–ª—é—á
OPENAI_ASSISTANT_ID=asst_LBGeLxauJ3nYbauR3pilbifN
```

### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –≤ Google Cloud

```bash
# API –∫–ª—é—á OpenAI
gcloud secrets create openai-api-key \
  --data-file=<(echo 'sk-–≤–∞—à-–∫–ª—é—á') \
  --project=tattoo-480007

# Assistant ID
gcloud secrets create openai-assistant-id \
  --data-file=<(echo 'asst_LBGeLxauJ3nYbauR3pilbifN') \
  --project=tattoo-480007
```

### –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç—å –¥–µ–ø–ª–æ–π –≤ Cloud Run

–û–±–Ω–æ–≤–∏—Ç–µ `deploy.sh` –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –ø—Ä–∏ –¥–µ–ø–ª–æ–µ:

```bash
gcloud run deploy telegram-bot \
  --source . \
  --platform managed \
  --region us-central1 \
  --project tattoo-480007 \
  --set-secrets=TELEGRAM_BOT_TOKEN=telegram-bot-token:latest,\
GOOGLE_SHEETS_ID=google-sheets-id:latest,\
GOOGLE_CREDENTIALS=google-credentials:latest,\
OPENAI_API_KEY=openai-api-key:latest,\
OPENAI_ASSISTANT_ID=openai-assistant-id:latest \
  --memory 512Mi \
  --min-instances 1 \
  --max-instances 1
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** –ü—Ä–∏–≤–µ—Ç!
**INKA:** –ü—Ä–∏–≤–µ—Ç! üòä –†–∞–¥–∞ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å! –ö–∞–∫ –¥–µ–ª–∞? –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?

### –ü—Ä–∏–º–µ—Ä 2: –í–æ–ø—Ä–æ—Å –æ —Ü–µ–Ω–µ
**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** –°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –º–∞–ª–µ–Ω—å–∫–∞—è —Ç–∞—Ç—É?
**INKA:** –¶–µ–Ω–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞, —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏ –º–µ—Å—Ç–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è. –û–±—ã—á–Ω–æ –Ω–µ–±–æ–ª—å—à–∏–µ —Ä–∞–±–æ—Ç—ã –æ—Ç 3000‚ÇΩ. –•–æ—á–µ—à—å –æ–±—Å—É–¥–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ? –ú–æ–≥—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å –º–∞—Å—Ç–µ—Ä–∞ –ê–Ω—é –¥–ª—è —Ç–æ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–∏.

### –ü—Ä–∏–º–µ—Ä 3: –û–±—Å—É–∂–¥–µ–Ω–∏–µ –∏–¥–µ–∏
**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** –•–æ—á—É —á—Ç–æ-—Ç–æ –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –Ω–∞ –∑–∞–ø—è—Å—Ç—å–µ
**INKA:** –û, –º–∏–Ω–∏–º–∞–ª–∏–∑–º ‚Äî —ç—Ç–æ –∫—Ä–∞—Å–∏–≤–æ! üí´ –ï—Å—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –∏–¥–µ–∏? –ú–æ–∂–µ—Ç, —Å–∏–º–≤–æ–ª, –ª–∏–Ω–∏–∏, –∏–ª–∏ —á—Ç–æ-—Ç–æ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–µ? –ê–Ω—è –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —ç—Ç–æ–º —Å—Ç–∏–ª–µ!

### –ü—Ä–∏–º–µ—Ä 4: –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** –î–∞, —Ö–æ—á—É —Å–∏–º–≤–æ–ª –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏
**INKA:** –û—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä! ‚àû –°–∏–º–≤–æ–ª –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏ –æ—á–µ–Ω—å –ø–æ–ø—É–ª—è—Ä–µ–Ω –∏ —Ö–æ—Ä–æ—à–æ —Å–º–æ—Ç—Ä–∏—Ç—Å—è –Ω–∞ –∑–∞–ø—è—Å—Ç—å–µ. –•–æ—á–µ—à—å –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é —Å –ê–Ω–µ–π? –û–Ω–∞ –ø–æ–∫–∞–∂–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏ –ø–æ–º–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å—Å—è —Å —Ä–∞–∑–º–µ—Ä–æ–º.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–æ–≤–æ–≥–æ INKA

### ‚úÖ –ß—Ç–æ —É–º–µ–µ—Ç
- –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–µ–ª–æ–≤–µ—á–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ
- –ó–∞–ø–æ–º–∏–Ω–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- –û—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –æ–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
- –ü—Ä–æ—è–≤–ª—è–µ—Ç —ç–º–ø–∞—Ç–∏—é
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —ç–º–æ–¥–∑–∏ —É–º–µ—Å—Ç–Ω–æ
- –ó–∞–¥–∞–µ—Ç —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
- –ß–µ—Å—Ç–Ω–æ –ø—Ä–∏–∑–Ω–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—Ç –æ—Ç–≤–µ—Ç–∞

### ‚ùå –ß—Ç–æ –Ω–µ –¥–µ–ª–∞–µ—Ç
- –ù–µ –ø—Ä–∏–¥—É–º—ã–≤–∞–µ—Ç —Ü–µ–Ω—ã –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- –ù–µ –¥–∞–≤–∏—Ç –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞
- –ù–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –≤–æ–ø—Ä–æ—Å—ã
- –ù–µ –æ—Ç–≤–µ—á–∞–µ—Ç —à–∞–±–ª–æ–Ω–Ω–æ

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí S1 (–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è) ‚Üí Routing
                                        ‚Üì
                            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                            ‚Üì           ‚Üì           ‚Üì
                        Booking    Conversation   Info
                            ‚Üì           ‚Üì           ‚Üì
                         S2 (Slots)  Assistant   Info DB
                            ‚Üì           ‚Üì           ‚Üì
                        S3 (Confirm)  Response   Response
```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

1. `/src/ai/inka.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –¥–ª—è –¥–∏–∞–ª–æ–≥–∞
2. `/src/bot/handlers/client_handler.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
3. `/src/config/config.py` - –¥–æ–±–∞–≤–ª–µ–Ω openai_assistant_id
4. `/setup_openai.py` - —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ "–ü—Ä–∏–≤–µ—Ç" –±–æ—Ç—É
2. –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ —Ü–µ–Ω–∞—Ö
3. –û–±—Å—É–¥–∏—Ç–µ –∏–¥–µ—é —Ç–∞—Ç—É–∏—Ä–æ–≤–∫–∏
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ Cloud Run:
```bash
gcloud logging read "resource.type=cloud_run_revision AND resource.labels.service_name=telegram-bot" \
  --limit=50 \
  --project=tattoo-480007 \
  --format="table(timestamp,severity,textPayload)"
```

## –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π –æ —Ü–µ–Ω–∞—Ö –∏ —É—Å–ª—É–≥–∞—Ö
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–æ–ø–∏—Å–∞–Ω–∏–µ —ç—Å–∫–∏–∑–æ–≤)
- [ ] –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å
- [ ] Sentiment analysis –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞
